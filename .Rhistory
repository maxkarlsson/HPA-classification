"Hart et al\nCell (2015)"))) %>%
{ggplot(., aes(name, n, fill = IDd_hpa))+
geom_bar(stat = "identity") +
geom_text(data = group_by(., name) %>%
summarise(n = sum(n)),
aes(name, n, label = n),
vjust = -1,
inherit.aes = F) +
ylab("Number of genes")+
xlab("")+
scale_y_continuous(expand = expand_scale(mult = c(0.01, 0.05)))+
scale_fill_manual(values = c("red", "gray"), name = "Expressed in all\nHPA tissues")+
plot_theme }
wang2015 <- "data/Wang2015_essential_genes.txt"
wang2015 %>%
read_delim(delim = "\t")
essential_genes_wang2015 <-
wang2015 %>%
read_delim(delim = "\t")
write_csv(Hart_ess,
paste(outpath, "Hart2015 essential genes.csv",sep='/'))
essential_genes_wang2015
select(ensg_id) %>%
mutate(IDd_hpa = ensg_id %in% {category_all %>% filter(frac.exp == 100) %$% ensg_id})
essential_genes_wang2015
essential_genes_wang2015
select(ensg_id)
Wang_ess <-
essential_genes_wang2015 %>%
select(ensg_id) %>%
mutate(IDd_hpa = ensg_id %in% {category_all %>% filter(frac.exp == 100) %$% ensg_id})
Wang_ess
write_csv(Wang_ess,
paste(outpath, "Wang2015 essential genes.csv",sep='/'))
tibble(name = c("HPA 2015\nUhlen et al\nScience (2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Hart et al\nCell (2015)",
"Hart et al\nCell (2015)",
"Wang et al\nScience (2015)",
"Wang et al\nScience (2015)"),
n = c(Tissue2015 %>%
summarise(n = length(which(`#detected tissues` == 32))) %$%
n,
category_all %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_bloodcells %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_celline %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_blood_celline_tiss %>%
nrow(),
Hart_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Hart_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n),
IDd_hpa = c("yes", "yes", "yes", "yes", "yes", "yes", "no", "yes", "no")) %>%
mutate(name = factor(name, levels = c("HPA 2015\nUhlen et al\nScience (2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Wang et al\nScience (2015)",
"Hart et al\nCell (2015)"))) %>%
{ggplot(., aes(name, n, fill = IDd_hpa))+
geom_bar(stat = "identity") +
geom_text(data = group_by(., name) %>%
summarise(n = sum(n)),
aes(name, n, label = n),
vjust = -1,
inherit.aes = F) +
ylab("Number of genes")+
xlab("")+
scale_y_continuous(expand = expand_scale(mult = c(0.01, 0.05)))+
scale_fill_manual(values = c("red", "gray"), name = "Expressed in all\nHPA tissues")+
plot_theme }
ggsave(paste(outpath, "Fig bar number essential genes.pdf",sep='/'), width=7, height=7)
tibble(name = c("HPA 2015\nUhlen et al\nScience\n(2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Hart et al\nCell\n(2015)",
"Hart et al\nCell\n(2015)",
"Wang et al\nScience\n(2015)",
"Wang et al\nScience\n(2015)"),
n = c(Tissue2015 %>%
summarise(n = length(which(`#detected tissues` == 32))) %$%
n,
category_all %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_bloodcells %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_celline %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_blood_celline_tiss %>%
nrow(),
Hart_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Hart_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n),
IDd_hpa = c("yes", "yes", "yes", "yes", "yes", "yes", "no", "yes", "no")) %>%
mutate(name = factor(name, levels = c("HPA 2015\nUhlen et al\nScience\n(2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Wang et al\nScience\n(2015)",
"Hart et al\nCell\n(2015)"))) %>%
{ggplot(., aes(name, n, fill = IDd_hpa))+
geom_bar(stat = "identity") +
geom_text(data = group_by(., name) %>%
summarise(n = sum(n)),
aes(name, n, label = n),
vjust = -1,
inherit.aes = F) +
ylab("Number of genes")+
xlab("")+
scale_y_continuous(expand = expand_scale(mult = c(0.01, 0.05)))+
scale_fill_manual(values = c("red", "gray"), name = "Expressed in all\nHPA tissues")+
plot_theme }
ggsave(paste(outpath, "Fig bar number essential genes.pdf",sep='/'), width=7, height=7)
Hart_ess
View(essential_genes_hart2015)
essential_genes_hart2015
## Essential genes
essential_genes_hart2015 <-
hart2015 %>%
readxl::read_excel(sheet = 1) %>%
filter(numTKOHits >= 3) %>%
inner_join(ensemblanno.table %>%
filter(ensg_id %in% unique(all.atlas.raw$ensg_id)),
by = c("Gene" = "gene_name"))
Hart_ess <-
essential_genes_hart2015 %>%
filter(numTKOHits >= 3) %>%
select(ensg_id) %>%
mutate(IDd_hpa = ensg_id %in% {category_all %>% filter(frac.exp == 100) %$% ensg_id})
tibble(name = c("HPA 2015\nUhlen et al\nScience\n(2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Hart et al\nCell\n(2015)",
"Hart et al\nCell\n(2015)",
"Wang et al\nScience\n(2015)",
"Wang et al\nScience\n(2015)"),
n = c(Tissue2015 %>%
summarise(n = length(which(`#detected tissues` == 32))) %$%
n,
category_all %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_bloodcells %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_celline %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_blood_celline_tiss %>%
nrow(),
Hart_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Hart_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n),
IDd_hpa = c("yes", "yes", "yes", "yes", "yes", "yes", "no", "yes", "no")) %>%
mutate(name = factor(name, levels = c("HPA 2015\nUhlen et al\nScience\n(2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Wang et al\nScience\n(2015)",
"Hart et al\nCell\n(2015)"))) %>%
{ggplot(., aes(name, n, fill = IDd_hpa))+
geom_bar(stat = "identity") +
geom_text(data = group_by(., name) %>%
summarise(n = sum(n)),
aes(name, n, label = n),
vjust = -1,
inherit.aes = F) +
ylab("Number of genes")+
xlab("")+
scale_y_continuous(expand = expand_scale(mult = c(0.01, 0.05)))+
scale_fill_manual(values = c("red", "gray"), name = "Expressed in all\nHPA tissues")+
plot_theme }
View(essential_genes_hart2015)
ensemblanno.table
category_celline <-
cell.lines.atlas %>%
rename(maxEx_column = "norm_exp",
consensus_content_column = "celline_name") %>%
mutate(maxEx_column = round(maxEx_column, 4)) %>%
group_by(ensg_id) %>%
summarise(num.exp = length(which(maxEx_column >= 1)),
frac.exp = num.exp/length(maxEx_column[!is.na(maxEx_column)])*100)
category_all <-
global.atlas.max %>%
rename(maxEx_column = maxEx_column,
consensus_content_column = consensus_content_column) %>%
mutate(maxEx_column = round(maxEx_column, 4)) %>%
group_by(ensg_id) %>%
summarise(num.exp = length(which(maxEx_column >= 1)),
frac.exp = num.exp/length(maxEx_column[!is.na(maxEx_column)])*100)
category_bloodcells <-
atlas.max %>%
rename(maxEx_column = maxEx_column,
consensus_content_column = consensus_content_column) %>%
mutate(maxEx_column = round(maxEx_column, 4)) %>%
group_by(ensg_id) %>%
summarise(num.exp = length(which(maxEx_column >= 1)),
frac.exp = num.exp/length(maxEx_column[!is.na(maxEx_column)])*100)
category_blood_celline_tiss <-
filter(category_all, frac.exp == 100) %>%
inner_join(filter(category_celline, frac.exp == 100),
by = "ensg_id") %>%
inner_join(filter(category_bloodcells, frac.exp == 100),
by = "ensg_id")
write_csv(category_blood_celline_tiss,
paste(outpath, "Genes exp all Blood - cell lines - tissues.csv",sep='/'))
Hart_ess <-
essential_genes_hart2015 %>%
filter(numTKOHits >= 3) %>%
select(ensg_id) %>%
mutate(IDd_hpa = ensg_id %in% {category_all %>% filter(frac.exp == 100) %$% ensg_id})
write_csv(Hart_ess,
paste(outpath, "Hart2015 essential genes.csv",sep='/'))
Wang_ess <-
essential_genes_wang2015 %>%
select(ensg_id) %>%
mutate(IDd_hpa = ensg_id %in% {category_all %>% filter(frac.exp == 100) %$% ensg_id})
write_csv(Wang_ess,
paste(outpath, "Wang2015 essential genes.csv",sep='/'))
tibble(name = c("HPA 2015\nUhlen et al\nScience\n(2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Hart et al\nCell\n(2015)",
"Hart et al\nCell\n(2015)",
"Wang et al\nScience\n(2015)",
"Wang et al\nScience\n(2015)"),
n = c(Tissue2015 %>%
summarise(n = length(which(`#detected tissues` == 32))) %$%
n,
category_all %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_bloodcells %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_celline %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_blood_celline_tiss %>%
nrow(),
Hart_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Hart_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n),
IDd_hpa = c("yes", "yes", "yes", "yes", "yes", "yes", "no", "yes", "no")) %>%
mutate(name = factor(name, levels = c("HPA 2015\nUhlen et al\nScience\n(2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Wang et al\nScience\n(2015)",
"Hart et al\nCell\n(2015)"))) %>%
{ggplot(., aes(name, n, fill = IDd_hpa))+
geom_bar(stat = "identity") +
geom_text(data = group_by(., name) %>%
summarise(n = sum(n)),
aes(name, n, label = n),
vjust = -1,
inherit.aes = F) +
ylab("Number of genes")+
xlab("")+
scale_y_continuous(expand = expand_scale(mult = c(0.01, 0.05)))+
scale_fill_manual(values = c("red", "gray"), name = "Expressed in all\nHPA tissues")+
plot_theme }
ggsave(paste(outpath, "Fig bar number essential genes.pdf",sep='/'), width=7, height=7)
category_blood_celline_tiss
Hart_ess <-
essential_genes_hart2015 %>%
filter(numTKOHits >= 3) %>%
select(ensg_id) %>%
mutate(IDd_hpa = ensg_id %in% {category_blood_celline_tiss %>% filter(frac.exp == 100) %$% ensg_id})
Wang_ess <-
essential_genes_wang2015 %>%
select(ensg_id) %>%
mutate(IDd_hpa = ensg_id %in% {category_blood_celline_tiss %>% filter(frac.exp == 100) %$% ensg_id})
tibble(name = c("HPA 2015\nUhlen et al\nScience\n(2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Hart et al\nCell\n(2015)",
"Hart et al\nCell\n(2015)",
"Wang et al\nScience\n(2015)",
"Wang et al\nScience\n(2015)"),
n = c(Tissue2015 %>%
summarise(n = length(which(`#detected tissues` == 32))) %$%
n,
category_all %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_bloodcells %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_celline %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_blood_celline_tiss %>%
nrow(),
Hart_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Hart_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n),
IDd_hpa = c("yes", "yes", "yes", "yes", "yes", "yes", "no", "yes", "no")) %>%
mutate(name = factor(name, levels = c("HPA 2015\nUhlen et al\nScience\n(2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Wang et al\nScience\n(2015)",
"Hart et al\nCell\n(2015)"))) %>%
{ggplot(., aes(name, n, fill = IDd_hpa))+
geom_bar(stat = "identity") +
geom_text(data = group_by(., name) %>%
summarise(n = sum(n)),
aes(name, n, label = n),
vjust = -1,
inherit.aes = F) +
ylab("Number of genes")+
xlab("")+
scale_y_continuous(expand = expand_scale(mult = c(0.01, 0.05)))+
scale_fill_manual(values = c("red", "gray"), name = "Expressed in all\nHPA tissues")+
plot_theme }
write_csv(category_blood_celline_tiss,
paste(outpath, "Genes exp all Blood - cell lines - tissues.csv",sep='/'))
Hart_ess <-
essential_genes_hart2015 %>%
filter(numTKOHits >= 3) %>%
select(ensg_id) %>%
mutate(IDd_hpa = ensg_id %in% {category_blood_celline_tiss %>% filter(frac.exp == 100) %$% ensg_id})
write_csv(Hart_ess,
paste(outpath, "Hart2015 essential genes.csv",sep='/'))
Wang_ess <-
essential_genes_wang2015 %>%
select(ensg_id) %>%
mutate(IDd_hpa = ensg_id %in% {category_blood_celline_tiss %>% filter(frac.exp == 100) %$% ensg_id})
write_csv(Wang_ess,
paste(outpath, "Wang2015 essential genes.csv",sep='/'))
tibble(name = c("HPA 2015\nUhlen et al\nScience\n(2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Hart et al\nCell\n(2015)",
"Hart et al\nCell\n(2015)",
"Wang et al\nScience\n(2015)",
"Wang et al\nScience\n(2015)"),
n = c(Tissue2015 %>%
summarise(n = length(which(`#detected tissues` == 32))) %$%
n,
category_all %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_bloodcells %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_celline %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_blood_celline_tiss %>%
nrow(),
Hart_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Hart_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n),
IDd_hpa = c("yes", "yes", "yes", "yes", "yes", "yes", "no", "yes", "no")) %>%
mutate(name = factor(name, levels = c("HPA 2015\nUhlen et al\nScience\n(2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Wang et al\nScience\n(2015)",
"Hart et al\nCell\n(2015)"))) %>%
{ggplot(., aes(name, n, fill = IDd_hpa))+
geom_bar(stat = "identity") +
geom_text(data = group_by(., name) %>%
summarise(n = sum(n)),
aes(name, n, label = n),
vjust = -1,
inherit.aes = F) +
ylab("Number of genes")+
xlab("")+
scale_y_continuous(expand = expand_scale(mult = c(0.01, 0.05)))+
scale_fill_manual(values = c("red", "gray"), name = "Expressed in all\nHPA tissues")+
plot_theme }
ggsave(paste(outpath, "Fig bar number essential genes.pdf",sep='/'), width=7, height=7)
tibble(name = c("HPA 2015\nUhlen et al\nScience\n(2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Hart et al\nCell\n(2015)",
"Hart et al\nCell\n(2015)",
"Wang et al\nScience\n(2015)",
"Wang et al\nScience\n(2015)"),
n = c(Tissue2015 %>%
summarise(n = length(which(`#detected tissues` == 32))) %$%
n,
category_all %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_bloodcells %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_celline %>%
summarise(n = length(which(frac.exp == 100))) %$%
n,
category_blood_celline_tiss %>%
nrow(),
Hart_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Hart_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(IDd_hpa))) %$%
n,
Wang_ess %>%
summarise(n = length(which(!IDd_hpa))) %$%
n),
IDd_hpa = c("yes", "yes", "yes", "yes", "yes", "yes", "no", "yes", "no")) %>%
mutate(name = factor(name, levels = c("HPA 2015\nUhlen et al\nScience\n(2015)",
"HPA 2019\nTissues",
"HPA 2019\nBlood cells",
"HPA 2019\nCell lines",
"HPA 2019\nBlood cells,\nCell lines,\nTissues",
"Wang et al\nScience\n(2015)",
"Hart et al\nCell\n(2015)"))) %>%
{ggplot(., aes(name, n, fill = IDd_hpa))+
geom_bar(stat = "identity") +
geom_text(data = group_by(., name) %>%
summarise(n = sum(n)),
aes(name, n, label = n),
vjust = -1,
inherit.aes = F) +
ylab("Number of genes")+
xlab("")+
scale_y_continuous(expand = expand_scale(mult = c(0.01, 0.05)))+
scale_fill_manual(values = c("red", "gray"), name = "Expressed in all\nHPA tissues,\ncell lines,\nand blood cells")+
plot_theme }
ggsave(paste(outpath, "Fig bar number essential genes.pdf",sep='/'), width=7, height=7)
